

% !TeX encoding = windows-1250
\chapter{Programski alati}
\qquad Prije samog rješavanja problematike kako napraviti navedenu aplikaciju, potrebno je objasniti što su i kako funkcioniraju korišteni softverski alati. Definirati æe se i koji su preduvjeti, tj. knjižnice ili alati koji svaki od njih zahtjeva da se može odraditi funkcija koja im je zadana za prethodno navedenu svrhu.

Korištene su najnovije dostupne te stabilne inaèice korištenih alata:
\begin{enumerate}
	\item ROS Noetic Ninjemys - datum izlaska 23. svibnja 2020.
	\item Unity 2019. LTS - izašlo polovicom 2020. godine.
	\item ROS\# 1.6 - datum izlaska 20. prosinca 2019.
\end{enumerate}
Sve to na najnovijoj tada dostupnoj LTS verziji Linux Ubuntu operacijskog sustava, 20.04 LTS.
\clearpage

\section{ROS}
\qquad Robotski Operacijski Sustav (ROS) je radni okvir (eng. framework) koji se instalira u Linux operacijski sustav i unatoè tome što sadrži rijeèi operacijski sustav, on to nije. Iako postoji i eksperimentalna verzija za Windows 10 i OS X, ovaj æe se rad usredotoèiti na razvoj na Linuxu radi kompatibilnosti s raznim alatima. Jedna od najbitnijih karakteristika ROS sustava jest da je omoguæena komunikacija i upravljanje hardverom robota preko softverskih alata ROS-a bez posebnih znanja o istima.

ROS se ponajviše koristio u znanstvene i obrazovne svrhe, ali se zbog svoje praktiènosti i potencijala ubrzo proširio i u ostale grane robotike. Prije prelaska na ROS, svaki proizvoðaè robota je trebao razvijati svoj API (Application Programming Interface) za komunikaciju i upravljanje svojim robotima. Sada roboti diljem svijeta veæinom koriste ROS kao svoj primarni sustav za komunikaciju i upravljanje, te je zbog toga vrlo korisno nauèiti služiti se istime te poznavati njegovu primjenu. Radi unificirane primjene ROS sustava, steèenim znanjima i vještinama moguæe je razviti softver koji æe poslužiti na razlièitim robotima, odnosno robotima razlièitih proizvoðaèa.

ROS sadrži razne alate i knjižnice, koji su razvijeni i posloženi po odreðenoj ROS konvenciji. Sve zajedno jako pojednostavljuje razvoj novih robotskih softvera i omoguæava kompleksno ponašanje robota. Takoðer ROS sadrži razne upravljaèke programe i algoritme, i sve je otvorenog koda - besplatno.\cite{rosurl}

Nedavno je razvijen i novi ROS, ROS 2. Prva službena verzija izdana je krajem 2017. Iako je preporuèljivo koristiti tehnologije otporne na buduænost (future-proof), za ovaj rad odabran je ROS 1 iz razloga što neki od kritiènih alata za uspjeh rada nisu podržani na najnovijim verzijama ROSa 2. Unatoè tome što je ROS 2 više otporan na buduænost i noviji, ROS 1 se i dalje razvija te nova verzija izlazi svake godine. Neke od razlika izmeðu ROSa 1 i 2 navedene su u tablici \ref{tab:rosversions}.
\begin{table}[!htbp]
	\scriptsize
	\renewcommand{\arraystretch}{1.2}
	\caption{ROS 1 i ROS 2 bitne razlike}
	\centering
	\begin{tabular}{|c|c|c|}
		\hline
		Znaèajka & ROS 1 & ROS 2
		\\ [0.5ex]
		\hline \hline
		Testirane platforme & Ubuntu & Ubuntu, OS X, Windows 10 \\ [0.5ex] % razmak do iducega retka
		C++ & C++11 & C++14, C++17 \\ [0.5ex]
		Python & Python 2 (Noetic Python 3) & Python 3.5 \\ [0.5ex]
		Roslaunch & XML & Python - kompleksnija logika \\ [0.5ex]
		Èvor u procesu & 1 & Više od 1 \\ [0.5ex]
		& Velika zajednica s puno stabilnih & Minimalne ovisnosti, bolja prenosivost, \\
		Ostalo & i odliènih paketa. & pouzdanost, perzistentnost i rad \\
		&  Puno literature i tutorijala. & u stvarnom vremenu (real-time).\\ [0.5ex]
		\hline
	\end{tabular}
	\label{tab:rosversions}
\end{table}

Za programiranje novih ROS èvorova koristio se Python programski jezik.

\clearpage

\section{Unity}
\qquad Unity je multi-platformsko (cross-platform) razvojno okruženje, primarno za razvijanje raèunalnih igara. Sveukupni razvoj Unity razvojnog okruženja radi amerièka korporacija Unity Technologies. Takoðer, sam softver je besplatan za edukacijske i osobne svrhe te komercijalne svrhe do 100.000 amerièkih dolara prihoda. Postoji veliki izbor besplatnih paketa i onih koji se naplaæuju koji se mogu koristiti za ubrzati i olakšati odreðene zadatke, a to se sve nalazi na tzv. \emph{Unity Asset Store}. \cite{unityassetstore}

Unity LTS (Long Term Support) verzija se u tekuæoj godini dovrši za prošlu - Unity 2019. LTS je došao sredinom 2020. godine, a nova, 2020. verzija je veæ dostupna i ona se postepeno nadograðuje. LTS verzija se svakog tjedna ažurira novim zakrpama (patch).

U sluèaju da je potrebno testirati aplikaciju na drugoj platformi, potrebno je imati instaliran Unity alat za željenu platformu. U sluèaju da je to Mac OS, tada je potrebno imati zasebnu instalaciju Unity-ja na željenom operacijskom sustavu da bi se mogla izgraditi aplikacija za taj sustav.

\subsection{Editor}

\qquad Unity Editor je glavni alat za razvoj (slika~\ref{fig:unityeditor}). U njemu se radi veæina razvoja oko vizualnih elemenata i interakcije izmeðu istih. Glavne komponente ureðivaèa su sljedeæe: 
\begin{enumerate}
	\item Hierarchy (hijerarhija) - Hijerarhijski prikaz svih elemenata u trenutnoj sceni. Unity svoje elemente u sceni naziva GameObject (igraèi objekt). 
	\item Scene (scena) - Glavni prozor gdje se radi sve u vezi s elementima koji se mogu grafièki prikazati.
	\item Game (igra) - Prozor koji služi kao emulacija igre. Pritiskom na "Play" gumb pokreæe se igra i ovaj prozor gdje se može igrati i vidjeti što i kako radi nakon izrade u scenskom prozoru.
	\item Inspector (inspektor) - Nakon odabira odreðenog elementa iz hijerarhije (element se takoðer može odabrati i u sceni), ovdje se prikazuju sve komponente nadodane na taj odabrani element tj. GameObject. Mogu se dodavati razne komponente koje Unity pruža, tipa prikaz slika i teksta, animacije, efekti i još mnogo toga, ali i skripte koje sama osoba koja razvija softver može napisati.
	\item Console (konzola) - Mjesto gdje se ispisuju sve poruke, upozorenja i greške. 
	\item Project (projekt) - Ovime se može upravljati arhitekturom projekta. Od klasiènog stvaranja mapa i datoteka, imenovanja i ostalog, do dodavanja specifiènih Unity dodataka.
	\item Ostalo - Meni traka u kojoj se mogu pristupiti svim ostalim postavkama (ukljuèujuæi i veæ navedenim stavkama). Dodatni alati se mogu postaviti kao aktivni i vidljivi, npr. pristup Asset Storeu, panel za animacije i animator te ostale stvari koje nisu vezane za ovaj rad. 
\end{enumerate}
\begin{figure}[!htbp]
	\begin{center}
		\includegraphics[height=12cm,width=21cm,keepaspectratio=true]{unitySS}
		\caption{Unity Editor}
		\label{fig:unityeditor}
	\end{center}
\end{figure}
\newpage

\subsection{Skripte}

\qquad Unity takoðer svojim korisnicima omoguæava programiranje vlastitih ili korištenje tuðih skripti. Programiranje se vrši u C\# programskom jeziku, koji se izvršava na \textit{Mono} razvojnom okruženju. Takoðer, moguæe je skripte programirati u \textit{JavaScriptu}, ali je podrška znatno lošija.

\qquad Cilj \textit{Mono} razvojnog okruženja je da omoguæi korištenje .NET Frameworka na razne operacijske sustave, jer je inaèe .NET framework razvijen od strane Microsofta samo za Windows OS. Komponente \textit{Mono} frameworka ukljuèuju:
\begin{enumerate}
	\item C\# kompajler - Potpun kompajler, sa svim znaèajkama od C\# 1.0 do 6.0.
	\item Mono Runtime \cite{monoabout} - Glavne komponente:
	\begin{itemize}
		\item Just-in-Time (JIT) kompajler - kompilacija koda tokom izvršavanja programa. 
		\item Ahead-of-Time (AOT) kompajler - kompilacija koda u nativni kod stroja gdje æe se izvršavati, prije njegovog izvršavanja.
		\item Èitaè knjižnica - omoguæuje nam uèitavanje vanjskih programskih knjižnica.
		\item Sakupljaè smeæa (Garbage collector) - automatsko brisanje objekata u memoriji koji se više ne koriste.
		\item Dretveni sustav - omoguæava izvršavanje više dretva (threads) istovremeno, pospješuje brzinu i produktivnost odreðenog programa ako je programirano na optimalan naèin.
		\item Interoperabilnost - karakteristika da više programskih sustava mogu bez poteškoæa meðusobno funkcionirati.
	\end{itemize}

	\item .NET Framework knjižnica klasa - \textit{Mono} platforma pruža set klasa kao temelj za razvijanje aplikacija. Navedene su klase kompatibilne s Microsoftovim .NET Framework klasama.
	\item \textit{Mono} pruža i dodatne klase koje nisu ukljuèene u Microsoftovim baznim klasama koje su posebice korisne za razvijanje Linux aplikacija, npr. Gtk+, Zip, OpenGL, Cairo, POSIX i druge.
\end{enumerate}
\qquad Glavne znaèajke \textit{Mono} radnog okruženja:
\begin{itemize}
	\item Multi-platformsko radno okruženje - Linux, macOS, BSD, Microsoft Windows.
	\item Multi-jezièan - C\#, VB 8, Java, Python, Ruby i još mnogi.
	\item Kompatibilan s binarnim kodom.
	\item Kompatibilan s Microsoft APIjem - pokreæe ASP.NET, ADO.NET, Silverlight i Windows.Forms.
	\item Otvorenog koda i besplatan - sav \textit{Mono} sadržaj, ukljuèujuæi i knjižnice, distribuiran je koristeæi MIT licencu.
	\item Opsežna pokrivenost - implementacije mnogih popularnih knjižnica i protokola.
\end{itemize}

\qquad Programiranje prilagoðenih skripti omoguæava kompleksna ponašanja i radnje u igri/softveru kojega se razvija. Gotovo sve akcije koje se može napraviti u Editoru, može se i u skripti, te se time može drastièno poveæati opseg moguænosti.
\clearpage

\section{ROS\#}
\qquad ROS\# je set programskih knjižnica i alata otvorenog koda u C\#u koja omoguæuje komunikaciju izmeðu ROS-a i .NET aplikacija - Unityja, razvijen od strane Siemens kompanije. Siemens je kompanija koja se bavi razvijanjem tehnologije za bitne ekonomske industrije (transport, tvornice i sl.). 

ROS\# je bio primarno razvijen za Windows operacijski sustav, ali se uspješno može koristiti i na druge operacijske sustave. Paket se može preuzeti s Unity Asset Storea ili direktno sa službenog Github repozitorija. \cite{rossharprepo} ROS\# je ujedno i glavni alat koji æe se koristiti u ovom radu za stvaranje mosta izmeðu ROSa i Unitya.

\qquad Glavni sadržaj ovog paketa je sljedeæi:
\begin{enumerate}
	\item .NET rješenje za RosBridgeClient (knjižnica koja omoguæuje spajanje vanjskih aplikacija na ROS sustav), URDF (robotski modeli) i MessageGeneration (generiranje poruka).
	\item ROS paketi korišteni od strane ROS\#a.
	\item Unity projekt koji sadrži primjer scenu te RosBridgeClient, Urdf i MessageGeneration ekstenzije za Unity.
\end{enumerate}

\subsection{RosBridgeClient}

\qquad RosBridgeClient za spajanje .NET baziranih aplikacija na ROS koristi \emph{rosbridge\_suite}. \emph{rosbridge\_suite} pruža ROSu API funkcionalnost za programe koji su izvan ROS sustava. Isti koristi naredbe bazirane na JSON formatu. Transportni sloj je implementiran u \emph{rosbridge\_server} paketu koji pruža WebSocket poveznicu. \cite{rosbridgesuite} WebSocket je konstantna poveznica izmeðu klijenta i servera gdje se promet odvija u oba smjera te koristi TCP/IP protokol.

